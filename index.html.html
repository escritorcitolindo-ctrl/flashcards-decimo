<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guggenheim Bilbao Explorer</title>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;600;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --gold: #d4af37;
            --titanium: #aeb2b5;
            --glass: rgba(255, 255, 255, 0.2);
            --success: #58cc02;
            --dark: #1a1a1a;
        }

        body {
            font-family: 'Outfit', sans-serif;
            background: linear-gradient(135deg, #1a1a1a 0%, #3d3d3d 100%);
            color: white;
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            overflow-x: hidden;
        }

        #quiz-card {
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            border: 2px solid var(--titanium);
            border-radius: 30px;
            width: 90%;
            max-width: 800px;
            padding: 40px;
            text-align: center;
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
            position: relative;
        }

        .scene-image {
            width: 100%;
            height: 250px;
            border-radius: 20px;
            object-fit: cover;
            margin-bottom: 20px;
            border: 3px solid var(--gold);
            transition: 0.5s;
        }

        .question-text {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 30px;
            color: #fff;
        }

        .options-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .option-btn {
            background: var(--glass);
            border: 2px solid var(--titanium);
            color: white;
            padding: 20px;
            border-radius: 15px;
            cursor: pointer;
            font-size: 18px;
            font-weight: 600;
            transition: 0.3s;
        }

        .option-btn:hover {
            background: var(--gold);
            color: black;
            transform: scale(1.03);
        }

        input[type="text"] {
            width: 80%;
            padding: 15px;
            border-radius: 15px;
            border: none;
            font-size: 20px;
            margin-bottom: 20px;
            background: #eee;
            color: #333;
        }

        .progress-container {
            width: 100%;
            height: 10px;
            background: #444;
            border-radius: 5px;
            margin-bottom: 30px;
        }

        #progress-bar {
            height: 100%;
            background: var(--gold);
            width: 0%;
            border-radius: 5px;
            transition: 0.5s;
        }

        .badge-unlock {
            animation: pop 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        @keyframes pop {
            0% { transform: scale(0); }
            100% { transform: scale(1); }
        }
    </style>
</head>
<body>

<div id="quiz-card">
    <div class="progress-container"><div id="progress-bar"></div></div>
    <div id="content">
        </div>
</div>

<script>
    const questions = [
        {
            type: "choice",
            q: "Who is the creative mind behind this groundbreaking building?",
            img: "https://images.unsplash.com/photo-1551633550-64771077673f?auto=format&fit=crop&w=800",
            options: ["Frank Gehry", "Frank Lloyd Wright", "Norman Foster", "Zaha Hadid"],
            correct: "Frank Gehry"
        },
        {
            type: "writing",
            q: "According to the text, the Museum is an architectural landmark of 'audacious configuration and __________ design'.",
            img: "https://images.unsplash.com/photo-1518005020251-098c17755e0a?auto=format&fit=crop&w=800",
            correct: "innovating"
        },
        {
            type: "choice",
            q: "What is the total size of the building?",
            img: "https://images.unsplash.com/photo-1549410195-60317e082531?auto=format&fit=crop&w=800",
            options: ["11,000 m¬≤", "24,000 m¬≤", "50,000 m¬≤", "15,000 m¬≤"],
            correct: "24,000 m¬≤"
        },
        {
            type: "listening",
            q: "Listen and identify the heart of the Museum.",
            img: "https://images.unsplash.com/photo-1558223153-f750d7789498?auto=format&fit=crop&w=800",
            audio: "Atrium",
            options: ["Atrium", "Garden", "Exit", "Hall"],
            correct: "Atrium"
        },
        {
            type: "choice",
            q: "The highest part of the building is shaped like a metal...?",
            img: "https://images.unsplash.com/photo-1518977676601-b53f82aba655?auto=format&fit=crop&w=800",
            options: ["Ship", "Cloud", "Flower", "Wave"],
            correct: "Flower"
        },
        {
            type: "writing",
            q: "Complete: The levels are connected by curved walkways, titanium and glass _________.",
            img: "https://images.unsplash.com/photo-1506461883276-594a12b11cf3?auto=format&fit=crop&w=800",
            correct: "elevators"
        },
        {
            type: "choice",
            q: "Is the Museum located in an old or newly developed area?",
            img: "https://images.unsplash.com/photo-1543158266-0066955047b1?auto=format&fit=crop&w=800",
            options: ["Old City", "Newly developed", "Industrial Park", "Beachfront"],
            correct: "Newly developed"
        },
        {
            type: "speaking",
            q: "Say it aloud: 'The Museum represents a magnificent example.'",
            img: "https://images.unsplash.com/photo-1502602898657-3e91760cbb34?auto=format&fit=crop&w=800",
            textToSay: "The Museum represents a magnificent example"
        }
    ];

    let current = 0;
    const content = document.getElementById('content');
    const bar = document.getElementById('progress-bar');
    let players = JSON.parse(localStorage.getItem('guggenheim_players') || '[]');

    function speak(text, rate = 0.8) {
        const u = new SpeechSynthesisUtterance(text);
        u.lang = 'en-US';
        u.rate = rate;
        window.speechSynthesis.speak(u);
    }

    function render() {
        if(current >= questions.length) return showEnd();
        const item = questions[current];
        bar.style.width = ((current / questions.length) * 100) + "%";
        
        let html = `<img src="${item.img}" class="scene-image">
                    <p class="question-text">${item.q}</p>`;

        if(item.type === "choice" || item.type === "listening") {
            html += `<div class="options-grid">`;
            item.options.forEach(opt => {
                html += `<button class="option-btn" onclick="check('${opt}')">${opt}</button>`;
            });
            html += `</div>`;
            if(item.type === "listening") speak(item.audio);
        } else if(item.type === "writing") {
            html += `<input type="text" id="ans" placeholder="Type here...">
                     <br><button class="btn" style="padding:15px 40px; border-radius:10px; background:var(--gold); border:none; font-weight:900; cursor:pointer" onclick="checkWriting()">CHECK</button>`;
        } else if(item.type === "speaking") {
            html += `<button class="option-btn" onclick="micSim()">üé§ CLICK TO SPEAK</button>
                     <p id="st" style="margin-top:10px; color:var(--gold)">Ready...</p>
                     <button class="option-btn" style="margin-top:10px" onclick="check(true)">CONTINUE</button>`;
        }

        content.innerHTML = html;
    }

    function micSim() {
        document.getElementById('st').innerText = "Recording... 'Magnificent example'";
        setTimeout(() => { document.getElementById('st').innerText = "Captured! Click continue."; }, 2000);
    }

    function checkWriting() {
        const val = document.getElementById('ans').value.toLowerCase().trim().replace(/[.,\/#!$%\^&\*;:{}=\-_`~()]/g,"");
        const target = questions[current].correct.toLowerCase();
        check(val === target);
    }

    function check(isCorrect) {
        if(typeof isCorrect === 'string') isCorrect = (isCorrect === questions[current].correct);
        
        if(isCorrect) {
            confetti({ particleCount: 100, spread: 70 });
            const p = Math.random() > 0.5 ? "GREAT JOB" : "GOOD WORK";
            speak(p);
            current++;
            setTimeout(render, 1500);
        } else {
            speak("ALMOST PERFECT");
            alert("Almost perfect! Try again.");
        }
    }

    function showEnd() {
        bar.style.width = "100%";
        content.innerHTML = `
            <h1 style="color:var(--gold); font-size:40px">GAME OVER</h1>
            <p>You have mastered the architecture of Bilbao!</p>
            <input type="text" id="pname" placeholder="Enter your name">
            <button class="option-btn" style="background:var(--success); color:white" onclick="save()">SAVE RECORD</button>
            <div style="margin-top:30px; text-align:left; background:rgba(255,255,255,0.1); padding:20px; border-radius:15px;">
                <h3>Hall of Fame:</h3>
                <ul id="list"></ul>
            </div>
        `;
        drawList();
    }

    function save() {
        const n = document.getElementById('pname').value;
        if(n) {
            players.push(n);
            localStorage.setItem('guggenheim_players', JSON.stringify(players));
            drawList();
            alert("Record saved!");
        }
    }

    function drawList() {
        const l = document.getElementById('list');
        if(l) l.innerHTML = players.map(p => `<li>üèõÔ∏è ${p} - Master Architect</li>`).join('');
    }

    render();
</script>
</body>
</html>